-- In the OHDSI tool, the selects are done on tables designated by placeholders (`@voc_project`.@voc_dataset)
-- that do not occur in any earlier workflow steps. Hence, it is not clear what tables should be used,
-- in particular whether it should be the standard OMOP ATHENA vocabularies or the adapted version
-- created earlier in the workflow. Conversely, it is unclear where the tables generated by the
-- vocabulary refresh process are used.
--
-- We make the assumption that these two open end match. That is, we use the output of the vocabulary
-- refresh flow as the input to this step.

-- affected by custom mapping

DROP TABLE IF EXISTS mimic_etl.voc_concept;
CREATE TABLE mimic_etl.voc_concept AS
SELECT * FROM mimic_staging.concept
;

DROP TABLE IF EXISTS mimic_etl.voc_concept_relationship;
CREATE TABLE mimic_etl.voc_concept_relationship AS
SELECT * FROM mimic_staging.concept_relationship
;

DROP TABLE IF EXISTS mimic_etl.voc_vocabulary;
CREATE TABLE mimic_etl.voc_vocabulary AS
SELECT * FROM mimic_staging.vocabulary
;

-- not affected by custom mapping

DROP TABLE IF EXISTS mimic_etl.voc_domain;
CREATE TABLE mimic_etl.voc_domain AS
SELECT * FROM mimic_staging.domain
;
DROP TABLE IF EXISTS mimic_etl.voc_concept_class;
CREATE TABLE mimic_etl.voc_concept_class AS
SELECT * FROM mimic_staging.concept_class
;
DROP TABLE IF EXISTS mimic_etl.voc_relationship;
CREATE TABLE mimic_etl.voc_relationship AS
SELECT * FROM mimic_staging.relationship
;
DROP TABLE IF EXISTS mimic_etl.voc_concept_synonym;
CREATE TABLE mimic_etl.voc_concept_synonym AS
SELECT * FROM mimic_staging.concept_synonym
;
DROP TABLE IF EXISTS mimic_etl.voc_concept_ancestor;
CREATE TABLE mimic_etl.voc_concept_ancestor AS
SELECT * FROM mimic_staging.concept_ancestor
;
DROP TABLE IF EXISTS mimic_etl.voc_drug_strength;
CREATE TABLE mimic_etl.voc_drug_strength AS
SELECT * FROM mimic_staging.drug_strength
;
